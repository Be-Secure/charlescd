{"ast":null,"code":"var _window$ENVIRONMENT;import defaultsDeep from'lodash/defaultsDeep';import isString from'lodash/isString';import{getAccessToken}from'core/utils/auth';import{getApplicationId}from'core/utils/workspace';import{getCircleId}from'core/utils/circle';export var buildHeaders=function buildHeaders(){return{Accept:'application/json',Authorization:\"Bearer \".concat(getAccessToken()),'Content-Type':'application/json','x-application-id':getApplicationId(),'x-circle-id':getCircleId()};};export var basePath=((_window$ENVIRONMENT=window.ENVIRONMENT)===null||_window$ENVIRONMENT===void 0?void 0:_window$ENVIRONMENT.REACT_APP_API_URI)||'/api';export var baseRequest=function baseRequest(url){var body=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;var options=arguments.length>2?arguments[2]:undefined;var defaultOptions={headers:buildHeaders(),body:isString(body)?body:JSON.stringify(body)};var mergedOptions=defaultsDeep(options,defaultOptions);return function(options){return fetch(\"\".concat(basePath).concat(url),defaultsDeep(mergedOptions,options)).then(function(response){if(!response.ok){return Promise.reject(response);}else{return response;}});};};","map":{"version":3,"sources":["/Users/ricardobasilio/projects/charlescd/ui/packages/new-ui/src/core/providers/base/index.ts"],"names":["defaultsDeep","isString","getAccessToken","getApplicationId","getCircleId","buildHeaders","Accept","Authorization","basePath","window","ENVIRONMENT","REACT_APP_API_URI","baseRequest","url","body","undefined","options","defaultOptions","headers","JSON","stringify","mergedOptions","fetch","then","response","ok","Promise","reject"],"mappings":"wBAAA,MAAOA,CAAAA,YAAP,KAAyB,qBAAzB,CACA,MAAOC,CAAAA,QAAP,KAAqB,iBAArB,CACA,OAASC,cAAT,KAA+B,iBAA/B,CACA,OAASC,gBAAT,KAAiC,sBAAjC,CACA,OAASC,WAAT,KAA4B,mBAA5B,CAEA,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,SAAO,CACjCC,MAAM,CAAE,kBADyB,CAEjCC,aAAa,kBAAYL,cAAc,EAA1B,CAFoB,CAGjC,eAAgB,kBAHiB,CAIjC,mBAAoBC,gBAAgB,EAJH,CAKjC,cAAeC,WAAW,EALO,CAAP,EAArB,CAkBP,MAAO,IAAMI,CAAAA,QAAQ,CAAG,sBAAAC,MAAM,CAACC,WAAP,kEAAoBC,iBAApB,GAAyC,MAA1D,CAEP,MAAO,IAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CACzBC,GADyB,CAIyB,IAFlDC,CAAAA,IAEkD,2DAFdC,SAEc,IADlDC,CAAAA,OACkD,2CAClD,GAAMC,CAAAA,cAAc,CAAG,CACrBC,OAAO,CAAEb,YAAY,EADA,CAErBS,IAAI,CAAEb,QAAQ,CAACa,IAAD,CAAR,CAAiBA,IAAjB,CAAwBK,IAAI,CAACC,SAAL,CAAeN,IAAf,CAFT,CAAvB,CAIA,GAAMO,CAAAA,aAAa,CAAGrB,YAAY,CAACgB,OAAD,CAAUC,cAAV,CAAlC,CAEA,MAAO,UAACD,OAAD,QACLM,CAAAA,KAAK,WAAId,QAAJ,SAAeK,GAAf,EAAsBb,YAAY,CAACqB,aAAD,CAAgBL,OAAhB,CAAlC,CAAL,CAAiEO,IAAjE,CACE,SAACC,QAAD,CAAwB,CACtB,GAAI,CAACA,QAAQ,CAACC,EAAd,CAAkB,CAChB,MAAOC,CAAAA,OAAO,CAACC,MAAR,CAAeH,QAAf,CAAP,CACD,CAFD,IAEO,CACL,MAAOA,CAAAA,QAAP,CACD,CACF,CAPH,CADK,EAAP,CAUD,CArBM","sourcesContent":["import defaultsDeep from 'lodash/defaultsDeep';\nimport isString from 'lodash/isString';\nimport { getAccessToken } from 'core/utils/auth';\nimport { getApplicationId } from 'core/utils/workspace';\nimport { getCircleId } from 'core/utils/circle';\n\nexport const buildHeaders = () => ({\n  Accept: 'application/json',\n  Authorization: `Bearer ${getAccessToken()}`,\n  'Content-Type': 'application/json',\n  'x-application-id': getApplicationId(),\n  'x-circle-id': getCircleId()\n});\n\nexport interface EnvVariables {\n  REACT_APP_API_URI: string;\n}\n\ndeclare global {\n  interface Window {\n    ENVIRONMENT: EnvVariables;\n  }\n}\n\nexport const basePath = window.ENVIRONMENT?.REACT_APP_API_URI || '/api';\n\nexport const baseRequest = (\n  url: string,\n  body: object | string | undefined = undefined,\n  options?: RequestInit\n): ((options: RequestInit) => Promise<Response>) => {\n  const defaultOptions = {\n    headers: buildHeaders(),\n    body: isString(body) ? body : JSON.stringify(body)\n  };\n  const mergedOptions = defaultsDeep(options, defaultOptions);\n\n  return (options?: RequestInit) =>\n    fetch(`${basePath}${url}`, defaultsDeep(mergedOptions, options)).then(\n      (response: Response) => {\n        if (!response.ok) {\n          return Promise.reject(response);\n        } else {\n          return response;\n        }\n      }\n    );\n};\n"]},"metadata":{},"sourceType":"module"}